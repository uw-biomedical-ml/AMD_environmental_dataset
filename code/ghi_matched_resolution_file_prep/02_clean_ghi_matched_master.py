import csv                                                                                                                                                                                                                                             
import sys                                                                                                                                                                                                                                      
sys.path.append("/Users/matthewhunt/Coding/Seattle_Research/IRIS_AMD_Environmental/Environmental_Data_Open_Source_Repo/code/")
import python_utils as pu                                                                                                                                                                                                                
load_file = 'processed_data/ghi_matched_master.tsv'                                                                                                                                                                                     
save_file = 'processed_data/ghi_matched_master_cleaned.tsv'                                                                                                                                                                             
with open(load_file,'r') as fin:                                                                                                                                                                                                         
  reader = csv.reader(fin,delimiter = '\t')                                                                                                                                                                                            
  header = next(reader)                                                                                                                                                                                                                
  reverse_hd = {i:el for i,el in enumerate(header)}                                                                                                                                                                                    
  output_list = []                                                                                                                                                                                                                     
  for row in reader:                                                                                                                                                                                                                   
      to_append = []                                                                                                                                                                                                                   
      for i,el in enumerate(row):                                                                                                                                                                                                      
          if int(float(el)) == -7777:                                                                                                                                                                                                  
              el = 0                                                                                                                                                                                                                   
          to_append.append(el)                                                                                                                                                                                                     
      output_list.append(to_append)                                                                                                                                                                                            
  output_list.insert(0,header)                                                                                                                                                                                             

pu.write_tsv(output_list,save_file)                                                                                                                                                                                      
print('written adn double chekcing')                                                                                                                                                                                     
for row in output_list:                                                                                                                                                                                                  
  assert -7777 not in row
